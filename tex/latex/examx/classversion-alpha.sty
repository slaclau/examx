\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{classversion-alpha}[2022/02/03 v0.01 Used for 
versioning classes]
\RequirePackage{xparse}
\RequirePackage{pgf}
\RequirePackage{readprov}
\RequirePackage{alphalph}

\def\classname#1{\gdef\@classname{#1} \title{Release information for 
\textsf{\@classname} class \classversion@currentRelease}}

\newcounter{classversion@file}
\setcounter{classversion@file}{0}
\newcounter{classversion@release}

\newcounter{classversion@int}

\NewDocumentCommand{\newrelease}{m}{
    \gdef\classversion@currentRelease{#1}
%    \newcounter{int}
%    \setcounter{int}{0}
%    \loop
}

\ExplSyntaxOn
\NewDocumentCommand{\IncludeFileInNextRelease}{m o}{
    \stepcounter{classversion@file}
    \cs_new:cpx {file\alphalph{\theclassversion@file}} {#1}
    \ReadFileInfos{#1}
    \cs_new:cpx {version\alphalph{\theclassversion@file}}  
    {\UseVersionOf{#1}}
    \cs_new:cpx {eversion\alphalph{\theclassversion@file}} {
        \IfNoValueTF{#2}{\UseVersionOf{#1}}{#2}
    }
    \cs_new:cpx {date\alphalph{\theclassversion@file}} {\UseDateOf{#1}}
}
\ExplSyntaxOff

\NewDocumentCommand{\NumberOfFilesInRelease}{}{\theclassversion@file}

\NewDocumentCommand{\thisinstallation}{O{Installation}}{
    \section*{#1}
    This installation of \textsf{\@classname} 
    consists of the following \NumberOfFilesInRelease\space files:
    \begingroup
    \setcounter{classversion@int}{0}
    \begin{enumerate}
    \loop
        \item
        \stepcounter{classversion@int}
        \edef\tempa{\csname version\alphalph{\theint}\endcsname}
        \edef\tempb{\csname eversion\alphalph{\theint}\endcsname}
        \csname file\alphalph{\theint}\endcsname~\csname 
        version\alphalph{\theint}\endcsname
        {\ifx\tempa\tempb\else{\space \bfseries\color{red} (expecting 
        \tempb)}\fi}, 
        dated \csname date\alphalph{\theint}\endcsname
    \ifnum\theclassversion@int<\NumberOfFilesInRelease    
    \repeat
    \end{enumerate}
    \endgroup
}
\NewDocumentCommand{\releasemanifest}{O{Release manifest}}{
    \section*{#1}
    This release (\classversion@currentRelease) of \textsf{\@classname} 
    consists of the following \NumberOfFilesInRelease\space files:
    \begingroup
    \setcounter{classversion@int}{0}
    \begin{enumerate}
        \loop
            \item
            \stepcounter{classversion@int}
            \csname file\alphalph{\theiint}\endcsname~\csname 
            version\alphalph{\theiint}\endcsname, dated \csname 
            date\alphalph{\theiint}\endcsname
        \ifnum\theclassversion@int<\NumberOfFilesInRelease 
        \repeat
    \end{enumerate}
    \endgroup
}


%
%& \csname file\alphalph{\theint}\endcsname & 
%\UseVersionOf{\csname file\alphalph{\theint}\endcsname} 
%& \UseDateOf{\csname file\alphalph{\theint}\endcsname}